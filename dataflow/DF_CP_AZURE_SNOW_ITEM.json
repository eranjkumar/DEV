{
	"name": "DF_CP_AZURE_SNOW_ITEM",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ITEM_TEST_SRC",
						"type": "DatasetReference"
					},
					"name": "SRS"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ITEM_TEST_TGT",
						"type": "DatasetReference"
					},
					"name": "TGT",
					"description": "Target Item Table in Snowflake"
				}
			],
			"transformations": [
				{
					"name": "SELECTALL",
					"description": "Select All the columns"
				},
				{
					"name": "checkitemtype",
					"description": "If item_type is null then assign '-1'"
				}
			],
			"scriptLines": [
				"source(output(",
				"          ITEMID as string,",
				"          ITEMDESCRIPTION as string,",
				"          ITEMTYPE as string,",
				"          LEVEL4MEMBERID as string,",
				"          LEVEL4MEMBERDESCRIPTION as string,",
				"          LEVEL3MEMBERID as string,",
				"          LEVEL3MEMBERDESCRIPTION as string,",
				"          LEVEL2MEMBERID as string,",
				"          LEVEL2MEMBERDESCRIPTION as string,",
				"          LEVEL1MEMBERID as string,",
				"          LEVEL1MEMBERDESCRIPTION as string,",
				"          ATTRSUPPLYTYPE as string,",
				"          ATTRORIGITEM as string,",
				"          ATTRVERSION as string,",
				"          UNITCOST as double,",
				"          ISNEWITEM as boolean,",
				"          ITEMCLASS as string,",
				"          HANDLINGINSTRUCTIONCODE as string,",
				"          ITEMFAMILYGROUP as string,",
				"          VOLUME as decimal(12,4),",
				"          UNITSPERPALLET as decimal(12,4),",
				"          ITEMPRIORITYATTRIB as string,",
				"          UNITCONV1 as double,",
				"          UNITCONV2 as double,",
				"          UNITCONV3 as double,",
				"          UNITCONV4 as double,",
				"          GROSSWEIGHT as decimal(12,4),",
				"          BASEUOM as string,",
				"          USEDYNDEPFROMITEMLOCDEPLOYMENTPARAM as boolean,",
				"          USETRANSPORTCOSTFROMDYNDEPSRC as boolean,",
				"          DYNDEPDECIMALS as decimal(38,0),",
				"          DYNDEPOPTION as decimal(38,0),",
				"          DYNDEPPUSHOPTION as decimal(38,0),",
				"          DYNDEPQTY as double,",
				"          OPTIONCLASS as string,",
				"          ITEMSOURCINGSTRATEGY as string,",
				"          OPTIONS as string,",
				"          DISABLENETTINGPLANNING as string,",
				"          ISSHORTLIFECYCLEITEM as boolean,",
				"          ISPARENTITEM as boolean,",
				"          UDC_TA as string,",
				"          UDC_ACTIVEPRINCIPLE as string,",
				"          UDC_CONTAINER as string,",
				"          UDC_MARKET as string,",
				"          UDC_MFGSOURCE as string,",
				"          UDC_PACKSIZE as decimal(12,0),",
				"          UDC_PHARMAFORM as string,",
				"          UDC_PRODUCTTYPE as string,",
				"          UDC_ITEMSTATUS as string,",
				"          UDC_EQUNITS as decimal(30,2),",
				"          UDC_BRAND as string,",
				"          UDC_TADESCR as string,",
				"          UDC_BRANDDESCR as string,",
				"          UDC_STRENGTHDESCR as string,",
				"          UDC_MP_RELEVANT as string,",
				"          UDC_FAMILY as string,",
				"          UDC_CORPDESCR as string,",
				"          UDC_SOPSW as boolean,",
				"          UDC_TPREGION as string,",
				"          UDC_DIVISION as string,",
				"          UDC_MULTIDEST as boolean,",
				"          UDC_MULTISOURCE as boolean,",
				"          UDC_BRANDPRIO as decimal(22,0),",
				"          UDC_ITEMEXCEPTION as decimal(22,0),",
				"          UDC_PACK_SITE as string,",
				"          UDC_PROD_SITE as string,",
				"          UDC_API_SITE as string,",
				"          UDC_GPSNAME as string,",
				"          UDC_GROUPING as string,",
				"          UDC_NBUNITSPERHNDLG as decimal(12,0),",
				"          UDC_NBHNDLGPERPALLET as decimal(12,0),",
				"          UDC_NBHNDLGPERLAYER as decimal(12,0),",
				"          UDC_PACKMODULE as string,",
				"          UDC_STORAGECONDITION as string,",
				"          UDC_GRP1 as string,",
				"          UDC_GRP2 as string,",
				"          UDC_GRP3 as string,",
				"          UDC_GRP4 as string,",
				"          UDC_CREATEDBY as string,",
				"          UDC_CREATIONDATE as date,",
				"          UDC_LASTUPDATEDATE as date,",
				"          UDC_LASTUPDATEDBY as string,",
				"          UDC_FACTOR as decimal(14,4),",
				"          UDC_ACTIVITY as string,",
				"          UDC_CRITICITY as decimal(30,2),",
				"          UDC_NPISW as boolean,",
				"          UDC_SIZETOBRAND as decimal(18,6),",
				"          UDC_ARCPROJSTATICSW as boolean,",
				"          UDC_PACKSPERPALLET as decimal(38,5),",
				"          UDC_RESTRICT_SW as boolean,",
				"          UDC_STACKINGPERPACK as decimal(38,0),",
				"          UDC_NBTABSPERBLISTER as decimal(22,0),",
				"          UDC_MTS_MTO as decimal(30,2),",
				"          UDC_NEW as boolean,",
				"          UDC_STRENGTH as string,",
				"          UDC_DOSETOMCG as decimal(38,10),",
				"          UDC_DOSETOIU as decimal(38,0),",
				"          UDC_DMDUNITLEVEL as decimal(38,0),",
				"          UDC_BOXTODOSES as decimal(38,0),",
				"          UDC_PACKSIZEDESCR as string,",
				"          UDC_FAMILYGRPDESCR as string,",
				"          UDC_LOCALPRODUCTSW as string,",
				"          UDC_SIZETOSTRENGTH as decimal(38,10),",
				"          UDC_LRPDUMMY as boolean,",
				"          UDC_LRPPRODLEVEL as string,",
				"          UDC_LRPSCOPE as boolean,",
				"          UDC_GPH as string,",
				"          UDC_GPHDESCR as string,",
				"          UDC_PACKAGINGSTYLE as string,",
				"          UDC_ACTIVEINGR as string,",
				"          UDC_SUPPLIERNAME as string,",
				"          UDC_PRODCONFIG as string,",
				"          UDC_PRODMACROCONFIG as string,",
				"          UDC_MACROCONFIGDESCR as string,",
				"          UDC_DMDUNITEXCEPTION as decimal(38,0),",
				"          UDC_PROJECTREF as string,",
				"          UDC_SECPACKPERBOX as decimal(38,10),",
				"          UDC_PACKERMFG as string,",
				"          UDC_GAUSSGLOBALCODE as string,",
				"          UDC_BFDP as string,",
				"          UDC_GPS as string,",
				"          UDC_SUPMFG as string,",
				"          UDC_PACKMFG as string,",
				"          UDC_ACTIVE as boolean,",
				"          UDC_GRPDVLP as string,",
				"          UDC_TABLET_SHAPE as string,",
				"          UDC_TXF_CONSTRAINED_DEMAND as boolean,",
				"          UDC_SBU_YPLUS1 as string,",
				"          UDC_SBU_DESC_YPLUS1 as string,",
				"          UDC_GBU_YPLUS1 as string,",
				"          UDC_BUSINESS_LINE as string,",
				"          UDC_SCM_CATEGORY as string,",
				"          UDC_DOSAGE_UOM as string,",
				"          UDC_API_DOSAGE as decimal(38,10),",
				"          UDC_PLNBUSLINE as string,",
				"          UDC_PLNBUSFIELD as string,",
				"          UDC_PLNBUSUNIT as string,",
				"          UDC_BUSINESS_FIELD as string,",
				"          UDC_BUSINESS_UNIT as string,",
				"          UDC_SCCATEGORY as string,",
				"          UDC_DEVICETYPE as string,",
				"          UDC_BUSDIV as string,",
				"          UDC_ISDUMMY as string,",
				"          UDC_FCSTTXFSTOP as date,",
				"          UDC_UOM as string,",
				"          UDC_LOCAL_BRAND as string,",
				"          UDC_UNITPERPALLET as decimal(38,10),",
				"          UDC_WEIGHT as decimal(38,10)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'parquet') ~> SRS",
				"SRS select(mapColumn(",
				"          each(match(/* All input columns */true()),",
				"               /* Input name */$$ = $$)",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SELECTALL",
				"SELECTALL derive(ITEMTYPE = iif(isNull(ITEMTYPE),'-1',ITEMTYPE)) ~> checkitemtype",
				"checkitemtype sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          ITEMID as string,",
				"          ITEMDESCRIPTION as string,",
				"          ITEMTYPE as string,",
				"          LEVEL4MEMBERID as string,",
				"          LEVEL4MEMBERDESCRIPTION as string,",
				"          LEVEL3MEMBERID as string,",
				"          LEVEL3MEMBERDESCRIPTION as string,",
				"          LEVEL2MEMBERID as string,",
				"          LEVEL2MEMBERDESCRIPTION as string,",
				"          LEVEL1MEMBERID as string,",
				"          LEVEL1MEMBERDESCRIPTION as string,",
				"          ATTRSUPPLYTYPE as string,",
				"          ATTRORIGITEM as string,",
				"          ATTRVERSION as string,",
				"          UNITCOST as double,",
				"          ISNEWITEM as boolean,",
				"          ITEMCLASS as string,",
				"          HANDLINGINSTRUCTIONCODE as string,",
				"          ITEMFAMILYGROUP as string,",
				"          VOLUME as decimal(12,4),",
				"          UNITSPERPALLET as decimal(12,4),",
				"          ITEMPRIORITYATTRIB as string,",
				"          UNITCONV1 as double,",
				"          UNITCONV2 as double,",
				"          UNITCONV3 as double,",
				"          UNITCONV4 as double,",
				"          GROSSWEIGHT as decimal(12,4),",
				"          BASEUOM as string,",
				"          USEDYNDEPFROMITEMLOCDEPLOYMENTPARAM as boolean,",
				"          USETRANSPORTCOSTFROMDYNDEPSRC as boolean,",
				"          DYNDEPDECIMALS as decimal(38,0),",
				"          DYNDEPOPTION as decimal(38,0),",
				"          DYNDEPPUSHOPTION as decimal(38,0),",
				"          DYNDEPQTY as double,",
				"          OPTIONCLASS as string,",
				"          ITEMSOURCINGSTRATEGY as string,",
				"          OPTIONS as string,",
				"          DISABLENETTINGPLANNING as string,",
				"          ISSHORTLIFECYCLEITEM as boolean,",
				"          ISPARENTITEM as boolean,",
				"          UDC_TA as string,",
				"          UDC_ACTIVEPRINCIPLE as string,",
				"          UDC_CONTAINER as string,",
				"          UDC_MARKET as string,",
				"          UDC_MFGSOURCE as string,",
				"          UDC_PACKSIZE as decimal(12,0),",
				"          UDC_PHARMAFORM as string,",
				"          UDC_PRODUCTTYPE as string,",
				"          UDC_ITEMSTATUS as string,",
				"          UDC_EQUNITS as decimal(30,2),",
				"          UDC_BRAND as string,",
				"          UDC_TADESCR as string,",
				"          UDC_BRANDDESCR as string,",
				"          UDC_STRENGTHDESCR as string,",
				"          UDC_MP_RELEVANT as string,",
				"          UDC_FAMILY as string,",
				"          UDC_CORPDESCR as string,",
				"          UDC_SOPSW as boolean,",
				"          UDC_TPREGION as string,",
				"          UDC_DIVISION as string,",
				"          UDC_MULTIDEST as boolean,",
				"          UDC_MULTISOURCE as boolean,",
				"          UDC_BRANDPRIO as decimal(22,0),",
				"          UDC_ITEMEXCEPTION as decimal(22,0),",
				"          UDC_PACK_SITE as string,",
				"          UDC_PROD_SITE as string,",
				"          UDC_API_SITE as string,",
				"          UDC_GPSNAME as string,",
				"          UDC_GROUPING as string,",
				"          UDC_NBUNITSPERHNDLG as decimal(12,0),",
				"          UDC_NBHNDLGPERPALLET as decimal(12,0),",
				"          UDC_NBHNDLGPERLAYER as decimal(12,0),",
				"          UDC_PACKMODULE as string,",
				"          UDC_STORAGECONDITION as string,",
				"          UDC_GRP1 as string,",
				"          UDC_GRP2 as string,",
				"          UDC_GRP3 as string,",
				"          UDC_GRP4 as string,",
				"          UDC_CREATEDBY as string,",
				"          UDC_CREATIONDATE as date,",
				"          UDC_LASTUPDATEDATE as date,",
				"          UDC_LASTUPDATEDBY as string,",
				"          UDC_FACTOR as decimal(14,4),",
				"          UDC_ACTIVITY as string,",
				"          UDC_CRITICITY as decimal(30,2),",
				"          UDC_NPISW as boolean,",
				"          UDC_SIZETOBRAND as decimal(18,6),",
				"          UDC_ARCPROJSTATICSW as boolean,",
				"          UDC_PACKSPERPALLET as decimal(38,5),",
				"          UDC_RESTRICT_SW as boolean,",
				"          UDC_STACKINGPERPACK as decimal(38,0),",
				"          UDC_NBTABSPERBLISTER as decimal(22,0),",
				"          UDC_MTS_MTO as decimal(30,2),",
				"          UDC_NEW as boolean,",
				"          UDC_STRENGTH as string,",
				"          UDC_DOSETOMCG as decimal(38,10),",
				"          UDC_DOSETOIU as decimal(38,0),",
				"          UDC_DMDUNITLEVEL as decimal(38,0),",
				"          UDC_BOXTODOSES as decimal(38,0),",
				"          UDC_PACKSIZEDESCR as string,",
				"          UDC_FAMILYGRPDESCR as string,",
				"          UDC_LOCALPRODUCTSW as string,",
				"          UDC_SIZETOSTRENGTH as decimal(38,10),",
				"          UDC_LRPDUMMY as boolean,",
				"          UDC_LRPPRODLEVEL as string,",
				"          UDC_LRPSCOPE as boolean,",
				"          UDC_GPH as string,",
				"          UDC_GPHDESCR as string,",
				"          UDC_PACKAGINGSTYLE as string,",
				"          UDC_ACTIVEINGR as string,",
				"          UDC_SUPPLIERNAME as string,",
				"          UDC_PRODCONFIG as string,",
				"          UDC_PRODMACROCONFIG as string,",
				"          UDC_MACROCONFIGDESCR as string,",
				"          UDC_DMDUNITEXCEPTION as decimal(38,0),",
				"          UDC_PROJECTREF as string,",
				"          UDC_SECPACKPERBOX as decimal(38,10),",
				"          UDC_PACKERMFG as string,",
				"          UDC_GAUSSGLOBALCODE as string,",
				"          UDC_BFDP as string,",
				"          UDC_GPS as string,",
				"          UDC_SUPMFG as string,",
				"          UDC_PACKMFG as string,",
				"          UDC_ACTIVE as boolean,",
				"          UDC_GRPDVLP as string,",
				"          UDC_TABLET_SHAPE as string,",
				"          UDC_TXF_CONSTRAINED_DEMAND as boolean,",
				"          UDC_SBU_YPLUS1 as string,",
				"          UDC_SBU_DESC_YPLUS1 as string,",
				"          UDC_GBU_YPLUS1 as string,",
				"          UDC_BUSINESS_LINE as string,",
				"          UDC_SCM_CATEGORY as string,",
				"          UDC_DOSAGE_UOM as string,",
				"          UDC_API_DOSAGE as decimal(38,10),",
				"          UDC_PLNBUSLINE as string,",
				"          UDC_PLNBUSFIELD as string,",
				"          UDC_PLNBUSUNIT as string,",
				"          UDC_BUSINESS_FIELD as string,",
				"          UDC_BUSINESS_UNIT as string,",
				"          UDC_SCCATEGORY as string,",
				"          UDC_DEVICETYPE as string,",
				"          UDC_BUSDIV as string,",
				"          UDC_ISDUMMY as string,",
				"          UDC_FCSTTXFSTOP as date,",
				"          UDC_UOM as string,",
				"          UDC_LOCAL_BRAND as string,",
				"          UDC_UNITPERPALLET as decimal(38,10),",
				"          UDC_WEIGHT as decimal(38,10)",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     truncate:true,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     stageInsert: true) ~> TGT"
			]
		}
	}
}